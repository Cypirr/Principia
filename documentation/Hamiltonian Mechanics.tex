\documentclass[10pt, a4paper, twoside]{basestyle}
\usepackage[Mathematics]{semtex}

%%%% Shorthands.

%%%% Title and authors.

\title{%
\textdisplay{%
An Introduction Hamiltonian Mechanics}%
}
\author{Robin~Leroy (eggrobin)}
\begin{document}
\maketitle
In this post I shall assume understanding of the concepts described in
chapter~4 (Conservation of Energy), chapter~8 (Motion) as well as sections
11--4 and 11--5 (Vectors and Vector algebra) of chapter~11 of Richard
Feynmann's \emph{Lectures on Physics}.

It is the continuation of my \emph{Introduction to Runge-Kutta Integrators},
but it does not rely on the concepts described in that post.

\section{Motivation}
We have previously seen how to compute the evolution of physical systems while
keeping the buildup of error in check. However, the error will still build up
over time. We would like to ensure that fundamental properties of the physical
system are preserved. For instance, we'd like a low strongly-bound orbit not to
turn into an escape trajectory (or a reentry) over time: we need conservation
of energy.

In order to make an integrator that conserves energy, it is helpful to look at
physics from a viewpoint where the conservation of energy is the fundamental
hypothesis, rather than a consequence of the application of some forces.

\newcommand{\Hamiltonian}{\mathscr{H}}
\section{Gravitation from a Hamiltonian viewpoint}
We consider a system of $N$ bodies $1$ through $N$, with masses $m_1$ through
$m_j$. The state of the system is defined by the \emph{positions} and
\emph{momenta} of those bodies. For each body $j$, the position $\vQ_j$ and the
momentum $\vP_j$ are 3-dimensional vectors, so the state of the entire system
lies in a $6N$-dimensional space, the \emph{classical\footnote{A similar
formalism exists for quantum mechanics, in which case we talk about the
\emph{quantum} phase space.} phase space}.
We can write the state as $\tuple{\vq, \vp}$, where $\vq = \tuple{q_1, \dotsc,
q_{3N}}$ and $\vp =  \tuple{p_1, \dotsc, p_{3N}}$ are $3N$-dimensional.

The total energy $\Hamiltonian$, the \emph{Hamiltonian} is a function
of the state of the system, the energy of a given state being $\Hamiltonian(\vq,
\vp)$.

The evolution of the state $\tuple{\vq, \vp}$ is given for each component $i\in
\set{1,\dotsc,3N}$, by the \emph{equations of motion}
\[
\begin{cases}
\deriv t {q_i} &= \deriv {p_i} \Hamiltonian \\
\deriv t {p_i} &= -\deriv {q_i} \Hamiltonian
\end{cases}.
\]
This is can be written\footnote{Readers familiar with multivariate calculus
might prefer the notations $\deriv t {\vq} = \grad_{\vp} \Hamiltonian,
\deriv t {\vp} = -\grad_{\vq} \Hamiltonian$, or $\derivop t 
\begin{pmatrix}
\vq \\
\vp
\end{pmatrix} =
\begin{pmatrix}
\nullmat    & \Identity \\
-\Identity & \nullmat
\end{pmatrix}
\grad \Hamiltonian$.}
as
\[
\begin{cases}
\deriv t {\vq} &= \deriv {\vp} \Hamiltonian \\
\deriv t {\vp} &= -\deriv {\vq} \Hamiltonian
\end{cases}.
\]
In this way, we have \emph{defined} the change in position and momentum as a
function of time, and thus completely desccribed how the system will evolve from
an initial state $\tuple{\vq_0, \vp_0}$.

From this formulation it immediately follows that energy is conserved:
indeed,
\begin{align*}
\deriv t \Hamiltonian &= \scal{\deriv \vq \Hamiltonian}{\deriv t \vq}
    + \scal{\deriv \vp \Hamiltonian}{\deriv t \vp} \\
&= \scal{\deriv \vq \Hamiltonian}{\deriv \vp \Hamiltonian}
    - \scal{\deriv \vp \Hamiltonian}{\deriv \vq \Hamiltonian} = 0.
\end{align*}

Here the energy is $\Hamiltonian = T + V$, where $T$ is the kinetic energy
and $V$ is the gravitational potential energy.
Since $T$ only depends on the momenta $\vp$ (recall that for body $j$,
$T_j = \frac{1}{2} m_j v_j^2$ and $\vP_j = m_j\vv_j$) and $V$ only depends
on the positions $\vq$, we get:
\[
\Hamiltonian\of{\vp, \vq} = T\of{\vp} + V\of{\vq}
\]
so the equations of motion become
\[
\begin{cases}
\deriv t {\vq} &= \deriv {\vp} T \\
\deriv t {\vp} &= -\deriv {\vq} V
\end{cases}.
\]
For a single body $j$, this gives us
\[
\begin{cases}
\deriv t {\vQ_j} &= \deriv {\vP_j} T = \derivop {\vP_j}\frac{1}{2} m_j v_j^2
    = v \\
\deriv t {\vP_j} &= -\deriv {\vq} V
\end{cases}.
\]
In other words, the change in position is the velocity, and the change in
momentum (the force) is in the direction which decreases the potential.
It helps to visualise the potential for a two-dimensional problem, where the
position of a body is given by $x$ and $y$. One can plot the potential
$V\of{x, y}$ as a hilly landscape, and the force is then directed downhill,
its magnitude proportional to the slope of the hill. A one-dimensional example
can be seen at \url{https://xkcd.com/681_large/}.

Let us for a moment consider a single body in a potential that does not vary
with time. Since the total energy is conserved, When the kinetic energy is
$0$, the body reaches its maximum height in the potential: it cannot be found at
any point with a greater potential unless external energy is imparted to it.
moreover, it cannot cross regions of higher potential.

It is therefore confined to some ``lake'' in the potential, whose height is
defined by its energy.

TODO PICTURE

\end{document}