
// .\Release\benchmarks.exe --benchmark_repetitions=5 --benchmark_min_time=30 --benchmark_filter=HarmonicOscillator                                                                                                                 // NOLINT(whitespace/line_length)
// Benchmarking on 1 X 3310 MHz CPU
// 2015/03/10-21:54:11
// Benchmark                                                                                           Time(ns)    CPU(ns) Iterations                                                                                               // NOLINT(whitespace/line_length)
// ----------------------------------------------------------------------------------------------------------------------------------                                                                                               // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Leapfrog>                                                 2530141569 2501216033          3                               +4.15606773735669070e-07 m, +4.16264394754398830e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Leapfrog>                                                 2504672583 2475215867          3                               +4.15606773735669070e-07 m, +4.16264394754398830e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Leapfrog>                                                 2496655997 2490815967          3                               +4.15606773735669070e-07 m, +4.16264394754398830e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Leapfrog>                                                 2496871210 2470015833          3                               +4.15606773735669070e-07 m, +4.16264394754398830e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Leapfrog>                                                 2517990963 2501216033          3                               +4.15606773735669070e-07 m, +4.16264394754398830e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Leapfrog>_mean                                            2509266464 2487695947          3                               +4.15606773735669070e-07 m, +4.16264394754398830e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Leapfrog>_stddev                                            13005052   12989679          0                               +4.15606773735669070e-07 m, +4.16264394754398830e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::PseudoLeapfrog>                                           2473274764 2470015833          3                               +4.15606773750305800e-07 m, +4.16261893789685730e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::PseudoLeapfrog>                                           2415063278 2407615433          3                               +4.15606773750305800e-07 m, +4.16261893789685730e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::PseudoLeapfrog>                                           2430808203 2402415400          3                               +4.15606773750305800e-07 m, +4.16261893789685730e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::PseudoLeapfrog>                                           2492488361 2444015667          3                               +4.15606773750305800e-07 m, +4.16261893789685730e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::PseudoLeapfrog>                                           2529791173 2454415733          3                               +4.15606773750305800e-07 m, +4.16261893789685730e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::PseudoLeapfrog>_mean                                      2468285156 2435695613          3                               +4.15606773750305800e-07 m, +4.16261893789685730e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::PseudoLeapfrog>_stddev                                      41547014   26433361          0                               +4.15606773750305800e-07 m, +4.16261893789685730e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order2Optimal>                          2566847698 2511616100          3                               +2.01686230361618200e-07 m, +2.02003871729904490e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order2Optimal>                          2545759495 2496016000          3                               +2.01686230361618200e-07 m, +2.02003871729904490e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order2Optimal>                          2540778216 2511616100          3                               +2.01686230361618200e-07 m, +2.02003871729904490e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order2Optimal>                          2555390970 2527216200          3                               +2.01686230361618200e-07 m, +2.02003871729904490e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order2Optimal>                          2549068904 2470015833          3                               +2.01686230361618200e-07 m, +2.02003871729904490e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order2Optimal>_mean                     2551569057 2503296047          3                               +2.01686230361618200e-07 m, +2.02003871729904490e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order2Optimal>_stddev                      8994308   19345242          0                               +2.01686230361618200e-07 m, +2.02003871729904490e-07 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Ruth1983>                                                 2659661270 2610416733          3                               +7.13595849077819370e-14 m, +8.22154844204447950e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Ruth1983>                                                 2690747873 2646816967          3                               +7.13595849077819370e-14 m, +8.22154844204447950e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Ruth1983>                                                 2645514385 2641616933          3                               +7.13595849077819370e-14 m, +8.22154844204447950e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Ruth1983>                                                 2633181549 2615616767          3                               +7.13595849077819370e-14 m, +8.22154844204447950e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Ruth1983>                                                 2594778991 2579216533          3                               +7.13595849077819370e-14 m, +8.22154844204447950e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Ruth1983>_mean                                            2644776814 2618736787          3                               +7.13595849077819370e-14 m, +8.22154844204447950e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Ruth1983>_stddev                                            31526693   24301464          0                               +7.13595849077819370e-14 m, +8.22154844204447950e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order3Optimal>                          2611508505 2600016667          3                               +6.86607888600310190e-14 m, +5.68867869477074350e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order3Optimal>                          2646055913 2615616767          3                               +6.86607888600310190e-14 m, +5.68867869477074350e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order3Optimal>                          2624375797 2615616767          3                               +6.86607888600310190e-14 m, +5.68867869477074350e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order3Optimal>                          2610708770 2600016667          3                               +6.86607888600310190e-14 m, +5.68867869477074350e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order3Optimal>                          2619167861 2579216533          3                               +6.86607888600310190e-14 m, +5.68867869477074350e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order3Optimal>_mean                     2622363369 2602096680          3                               +6.86607888600310190e-14 m, +5.68867869477074350e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order3Optimal>_stddev                     12878319   13399549          0                               +6.86607888600310190e-14 m, +5.68867869477074350e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::CandyRozmus1991ForestRuth1990SynchronousMomenta>          2877655403 2808018000          3                               +1.64770974642181050e-13 m, +1.64847302475124020e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::CandyRozmus1991ForestRuth1990SynchronousMomenta>          2799449420 2782017833          3                               +1.64770974642181050e-13 m, +1.64847302475124020e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::CandyRozmus1991ForestRuth1990SynchronousMomenta>          2758637007 2750817633          3                               +1.64770974642181050e-13 m, +1.64847302475124020e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::CandyRozmus1991ForestRuth1990SynchronousMomenta>          2755019164 2761217700          3                               +1.64770974642181050e-13 m, +1.64847302475124020e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::CandyRozmus1991ForestRuth1990SynchronousMomenta>          2760717925 2745617600          3                               +1.64770974642181050e-13 m, +1.64847302475124020e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::CandyRozmus1991ForestRuth1990SynchronousMomenta>_mean     2790295784 2769537753          3                               +1.64770974642181050e-13 m, +1.64847302475124020e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::CandyRozmus1991ForestRuth1990SynchronousMomenta>_stddev     46555472   22927371          0                               +1.64770974642181050e-13 m, +1.64847302475124020e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::CandyRozmus1991ForestRuth1990SynchronousPositions>        2776107765 2735217533          3                               +1.64717198214425760e-13 m, +1.64795260770844720e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::CandyRozmus1991ForestRuth1990SynchronousPositions>        2832975603 2792417900          3                               +1.64717198214425760e-13 m, +1.64795260770844720e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::CandyRozmus1991ForestRuth1990SynchronousPositions>        2749778168 2740417567          3                               +1.64717198214425760e-13 m, +1.64795260770844720e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::CandyRozmus1991ForestRuth1990SynchronousPositions>        2736743745 2724817467          3                               +1.64717198214425760e-13 m, +1.64795260770844720e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::CandyRozmus1991ForestRuth1990SynchronousPositions>        2735193150 2735217533          3                               +1.64717198214425760e-13 m, +1.64795260770844720e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::CandyRozmus1991ForestRuth1990SynchronousPositions>_mean   2766159686 2745617600          3                               +1.64717198214425760e-13 m, +1.64795260770844720e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::CandyRozmus1991ForestRuth1990SynchronousPositions>_stddev   36485364   23942751          0                               +1.64717198214425760e-13 m, +1.64795260770844720e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order4Optimal>                          2743296918 2730017500          3                               +8.21200746292660710e-14 m, +8.20767065423666510e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order4Optimal>                          2737295127 2724817467          3                               +8.21200746292660710e-14 m, +8.20767065423666510e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order4Optimal>                          2727385180 2714417400          3                               +8.21200746292660710e-14 m, +8.20767065423666510e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order4Optimal>                          2732378698 2719617433          3                               +8.21200746292660710e-14 m, +8.20767065423666510e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order4Optimal>                          2743296441 2745617600          3                               +8.21200746292660710e-14 m, +8.20767065423666510e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order4Optimal>_mean                     2736730473 2726897480          3                               +8.21200746292660710e-14 m, +8.20767065423666510e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order4Optimal>_stddev                      6210015   10707524          0                               +8.21200746292660710e-14 m, +8.20767065423666510e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order5Optimal>                          3019931213 2995219200          3                               +1.37018868473504090e-13 m, +1.37057032389975570e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order5Optimal>                          3016872939 3000419233          3                               +1.37018868473504090e-13 m, +1.37057032389975570e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order5Optimal>                          3028517938 3026419400          2                               +1.37018868473504090e-13 m, +1.37057032389975570e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order5Optimal>                          3023372746 3010819300          2                               +1.37018868473504090e-13 m, +1.37057032389975570e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order5Optimal>                          2999717212 3000419233          3                               +1.37018868473504090e-13 m, +1.37057032389975570e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order5Optimal>_mean                     3016411189 3004819262          2                               +1.37018868473504090e-13 m, +1.37057032389975570e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::McLachlanAtela1992Order5Optimal>_stddev                      9860376   10369252          0                               +1.37018868473504090e-13 m, +1.37057032389975570e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6A>                                       3377472735 3338421400          2                               +2.08746214758193100e-13 m, +2.09027239961301350e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6A>                                       3366953588 3346221450          2                               +2.08746214758193100e-13 m, +2.09027239961301350e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6A>                                       3364518619 3354021500          2                               +2.08746214758193100e-13 m, +2.09027239961301350e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6A>                                       3376458741 3338421400          2                               +2.08746214758193100e-13 m, +2.09027239961301350e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6A>                                       3403869009 3354021500          2                               +2.08746214758193100e-13 m, +2.09027239961301350e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6A>_mean                                  3377854538 3346221450          2                               +2.08746214758193100e-13 m, +2.09027239961301350e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6A>_stddev                                  13967993    6976577          0                               +2.08746214758193100e-13 m, +2.09027239961301350e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6B>                                       3381581760 3377421650          2                               +3.59743485001118300e-13 m, +3.60239615915247670e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6B>                                       3389777637 3377421650          2                               +3.59743485001118300e-13 m, +3.60239615915247670e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6B>                                       3385528064 3385221700          2                               +3.59743485001118300e-13 m, +3.60239615915247670e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6B>                                       3409860707 3361821550          2                               +3.59743485001118300e-13 m, +3.60239615915247670e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6B>                                       3348230458 3330621350          2                               +3.59743485001118300e-13 m, +3.60239615915247670e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6B>_mean                                  3382995725 3366501580          2                               +3.59743485001118300e-13 m, +3.60239615915247670e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6B>_stddev                                  19923641   19484519          0                               +3.59743485001118300e-13 m, +3.60239615915247670e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6C>                                       3440334773 3393021750          2                               +1.66231611808953520e-13 m, +1.66453656413878550e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6C>                                       3378280855 3377421650          2                               +1.66231611808953520e-13 m, +1.66453656413878550e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6C>                                       3424521542 3385221700          2                               +1.66231611808953520e-13 m, +1.66453656413878550e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6C>                                       3374680257 3354021500          2                               +1.66231611808953520e-13 m, +1.66453656413878550e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6C>                                       3343928433 3346221450          2                               +1.66231611808953520e-13 m, +1.66453656413878550e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6C>_mean                                  3392349172 3371181610          2                               +1.66231611808953520e-13 m, +1.66453656413878550e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order6C>_stddev                                  35191918   18058421          0                               +1.66231611808953520e-13 m, +1.66453656413878550e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8A>                                       4580600477 4570829300          2                               +5.11861386609524520e-13 m, +5.12544867659059380e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8A>                                       4587157345 4586429400          2                               +5.11861386609524520e-13 m, +5.12544867659059380e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8A>                                       4660788274 4648829800          2                               +5.11861386609524520e-13 m, +5.12544867659059380e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8A>                                       4631403780 4617629600          2                               +5.11861386609524520e-13 m, +5.12544867659059380e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8A>                                       4604475475 4594229450          2                               +5.11861386609524520e-13 m, +5.12544867659059380e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8A>_mean                                  4612885070 4603589510          2                               +5.11861386609524520e-13 m, +5.12544867659059380e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8A>_stddev                                  29707210   27199704          0                               +5.11861386609524520e-13 m, +5.12544867659059380e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8B>                                       4551770664 4539629100          2                               +1.74530528918026560e-13 m, +1.74762981863807450e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8B>                                       4500064826 4469428650          2                               +1.74530528918026560e-13 m, +1.74762981863807450e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8B>                                       4519759393 4516228950          2                               +1.74530528918026560e-13 m, +1.74762981863807450e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8B>                                       4690918899 4617629600          2                               +1.74530528918026560e-13 m, +1.74762981863807450e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8B>                                       4721586919 4625429650          2                               +1.74530528918026560e-13 m, +1.74762981863807450e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8B>_mean                                  4596820140 4553669190          2                               +1.74530528918026560e-13 m, +1.74762981863807450e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8B>_stddev                                  91379134   59893008          0                               +1.74530528918026560e-13 m, +1.74762981863807450e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8C>                                       4583848215 4539629100          2                               +4.31519403543134670e-13 m, +4.32123087312774600e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8C>                                       4642975426 4500628850          2                               +4.31519403543134670e-13 m, +4.32123087312774600e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8C>                                       4575709439 4508428900          2                               +4.31519403543134670e-13 m, +4.32123087312774600e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8C>                                       4487327195 4446028500          2                               +4.31519403543134670e-13 m, +4.32123087312774600e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8C>                                       4484209872 4453828550          2                               +4.31519403543134670e-13 m, +4.32123087312774600e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8C>_mean                                  4554814029 4489708780          2                               +4.31519403543134670e-13 m, +4.32123087312774600e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8C>_stddev                                  60977789   35091557          0                               +4.31519403543134670e-13 m, +4.32123087312774600e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8D>                                       4800219274 4695630100          2                               +2.44630704582249340e-13 m, +2.44953363148781020e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8D>                                       4729811526 4625429650          2                               +2.44630704582249340e-13 m, +2.44953363148781020e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8D>                                       4699321485 4570829300          2                               +2.44630704582249340e-13 m, +2.44953363148781020e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8D>                                       4712693072 4555229200          2                               +2.44630704582249340e-13 m, +2.44953363148781020e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8D>                                       4732854462 4672229950          2                               +2.44630704582249340e-13 m, +2.44953363148781020e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8D>_mean                                  4734979964 4623869640          2                               +2.44630704582249340e-13 m, +2.44953363148781020e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8D>_stddev                                  34801238   54800556          0                               +2.44630704582249340e-13 m, +2.44953363148781020e-13 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8E>                                       4656371928 4594229450          2                               +8.20819107127945810e-14 m, +8.20281342850393000e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8E>                                       4655170656 4531829050          2                               +8.20819107127945810e-14 m, +8.20281342850393000e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8E>                                       4655148721 4609829550          2                               +8.20819107127945810e-14 m, +8.20281342850393000e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8E>                                       4647469139 4492828800          2                               +8.20819107127945810e-14 m, +8.20281342850393000e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8E>                                       4691294766 4625429650          2                               +8.20819107127945810e-14 m, +8.20281342850393000e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8E>_mean                                  4661091042 4570829300          2                               +8.20819107127945810e-14 m, +8.20281342850393000e-14 m kg s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<&Integrator::Yoshida1990Order8E>_stddev                                  15430187   50308811          0                               +8.20819107127945810e-14 m, +8.20281342850393000e-14 m kg s^-1  // NOLINT(whitespace/line_length)

#define GLOG_NO_ABBREVIATED_SEVERITIES

#include "integrators/symplectic_partitioned_runge_kutta_integrator.hpp"

#include <algorithm>
#include <vector>

#include "base/not_null.hpp"
#include "quantities/elementary_functions.hpp"
#include "quantities/named_quantities.hpp"
#include "testing_utilities/numerical_analysis.hpp"

// Must come last to avoid conflicts when defining the CHECK macros.
#include "benchmark/benchmark.h"

namespace principia {

using integrators::SPRKIntegrator;
using integrators::SRKNIntegrator;
using quantities::Abs;
using quantities::AngularFrequency;
using quantities::Cos;
using quantities::Length;
using quantities::SIUnit;
using testing_utilities::ComputeHarmonicOscillatorAcceleration;

namespace benchmarks {

void SolveHarmonicOscillatorAndComputeError(
    not_null<benchmark::State*> const state,
    not_null<Length*> const q_error,
    not_null<Speed*> const v_error,
    SRKNIntegrator const& integrator) {
  SRKNIntegrator::Solution<Length, Speed> solution;
  SRKNIntegrator::Parameters<Length, Speed> parameters;

  parameters.initial.positions.emplace_back(SIUnit<Length>());
  parameters.initial.momenta.emplace_back(Speed());
  parameters.initial.time = Time();
#ifdef _DEBUG
  parameters.tmax = 100.0 * SIUnit<Time>();
#else
  parameters.tmax = 1000.0 * SIUnit<Time>();
#endif
  parameters.Δt = 1.0E-4 * SIUnit<Time>();
  parameters.sampling_period = 1;
  integrator.SolveTrivialKineticEnergyIncrement<Length>(
      &ComputeHarmonicOscillatorAcceleration,
      parameters,
      &solution);

  state->PauseTiming();
  *q_error = Length();
  *v_error = Speed();
  for (std::size_t i = 0; i < solution.size(); ++i) {
    *q_error = std::max(*q_error,
                        Abs(solution[i].positions[0].value -
                            SIUnit<Length>() *
                            Cos(solution[i].time.value *
                                SIUnit<AngularFrequency>())));
    *v_error = std::max(*v_error,
                        Abs(solution[i].momenta[0].value +
                            SIUnit<Speed>() *
                            Sin(solution[i].time.value *
                                SIUnit<AngularFrequency>())));
  }
  state->ResumeTiming();
}

template<typename Integrator, Integrator const& (*integrator)()>
void BM_SolveHarmonicOscillator(
    benchmark::State& state) {  // NOLINT(runtime/references)
  Length q_error;
  Speed v_error;
  while (state.KeepRunning()) {
    SolveHarmonicOscillatorAndComputeError(&state, &q_error, &v_error,
                                           integrator());
  }
  std::stringstream ss;
  ss << q_error << ", " << v_error;
  state.SetLabel(ss.str());
}

BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &integrators::Leapfrog);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &integrators::PseudoLeapfrog);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &integrators::McLachlanAtela1992Order2Optimal);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &integrators::Ruth1983);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &integrators::McLachlanAtela1992Order3Optimal);
BENCHMARK_TEMPLATE2(
    BM_SolveHarmonicOscillator, SPRKIntegrator,
    &integrators::CandyRozmus1991ForestRuth1990SynchronousMomenta);
BENCHMARK_TEMPLATE2(
    BM_SolveHarmonicOscillator, SPRKIntegrator,
    &integrators::CandyRozmus1991ForestRuth1990SynchronousPositions);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SRKNIntegrator,
                    &integrators::McLachlanAtela1992Order4Optimal);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SRKNIntegrator,
                    &integrators::McLachlanAtela1992Order5Optimal);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &integrators::Yoshida1990Order6A);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &integrators::Yoshida1990Order6B);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &integrators::Yoshida1990Order6C);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &integrators::Yoshida1990Order8A);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &integrators::Yoshida1990Order8B);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &integrators::Yoshida1990Order8C);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &integrators::Yoshida1990Order8D);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &integrators::Yoshida1990Order8E);

}  // namespace benchmarks
}  // namespace principia
