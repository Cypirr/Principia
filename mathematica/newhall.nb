(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     25412,        637]
NotebookOptionsPosition[     23714,        583]
NotebookOutlinePosition[     24137,        599]
CellTagsIndexPosition[     24094,        596]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Numerical Representation of Planetary Ephemerides", "Title",
 CellChangeTimes->{{3.6408572436716843`*^9, 3.64085726272859*^9}}],

Cell["X. X. Newhall, Celestial Mechanics 45:305-310, 1989", "Subtitle",
 CellChangeTimes->{{3.6408572972460413`*^9, 3.640857306555972*^9}, {
  3.640857445376853*^9, 3.6408574627925944`*^9}, {3.641452803668113*^9, 
  3.641452816399113*^9}}],

Cell[CellGroupData[{

Cell["Computations", "Section",
 CellChangeTimes->{{3.640871927223524*^9, 3.6408719381116133`*^9}}],

Cell["\<\
A handy function to compute the derivative of a Chebyshev polynomial.\
\>", "Text",
 CellChangeTimes->{{3.6408551478157153`*^9, 3.640855175391473*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DChebyshevT", "=", 
  RowBox[{
   RowBox[{"Derivative", "[", 
    RowBox[{"0", ",", "1"}], "]"}], "[", "ChebyshevT", "]"}]}]], "Input",
 CellChangeTimes->{{3.640854276810122*^9, 3.640854382943734*^9}, {
   3.6408544132097607`*^9, 3.640854419777417*^9}, {3.640854498084247*^9, 
   3.640854501851624*^9}, {3.6408548918256173`*^9, 3.6408549372751617`*^9}, {
   3.6408549840778418`*^9, 3.6408549984772816`*^9}, {3.6408550959450274`*^9, 
   3.6408551280662394`*^9}, 3.6408553176266947`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChebyshevU", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "#1"}], ",", "#2"}], "]"}], " ", "#1"}], 
  "&"}]], "Output",
 CellChangeTimes->{3.6408549995133853`*^9, 3.6408551285902915`*^9, 
  3.6408553183497667`*^9, 3.64085677400062*^9, 3.640856812041424*^9, 
  3.640856870574276*^9, 3.6410549471087694`*^9, 3.641225652005228*^9, 
  3.6414528265781136`*^9}]
}, Open  ]],

Cell[TextData[{
 "This function computes matrix ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]]],
 " from Newhall\[CloseCurlyQuote]s equation (5).  The parameter ",
 Cell[BoxData[
  FormBox["degree", TraditionalForm]]],
 " is the degree of the polynomial (",
 Cell[BoxData[
  FormBox["N", TraditionalForm]]],
 " in Newhall), the parameter ",
 Cell[BoxData[
  FormBox["divisions", TraditionalForm]]],
 " is the number of subintervals of [-1, 1] (8 in Newhall)."
}], "Text",
 CellChangeTimes->{{3.640839399896345*^9, 3.640839453946749*^9}, {
   3.640839520893443*^9, 3.640839628233176*^9}, {3.6408396601903715`*^9, 
   3.6408397089242444`*^9}, {3.640839760713423*^9, 3.640839799832837*^9}, {
   3.6408399149353456`*^9, 3.640839922202072*^9}, 3.640855183989332*^9, {
   3.640857472689584*^9, 3.6408574772970448`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewhallT", "[", 
   RowBox[{"degree_Integer", ",", "divisions_Integer"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ChebyshevT", "[", 
           RowBox[{"j", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", "degree"}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"DChebyshevT", "[", 
           RowBox[{"j", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", "degree"}], "}"}]}], "]"}]}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{
         RowBox[{"-", "2"}], "/", "divisions"}]}], "}"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.640836488564534*^9, 3.640836605865263*^9}, {
   3.6408366911477904`*^9, 3.6408367200636835`*^9}, {3.640836752400917*^9, 
   3.640836763649042*^9}, {3.640836810770754*^9, 3.6408368214278193`*^9}, {
   3.640837272260898*^9, 3.640837281171789*^9}, {3.6408376823078985`*^9, 
   3.64083778611168*^9}, {3.6408389748198414`*^9, 3.640839024541813*^9}, {
   3.6408392742327795`*^9, 3.640839284204777*^9}, {3.640839396058961*^9, 
   3.6408393978211374`*^9}, {3.640853921398981*^9, 3.640853964120253*^9}, {
   3.6408551885357866`*^9, 3.6408552025941925`*^9}, {3.6414523449769354`*^9, 
   3.641452357316169*^9}, 3.641453300163113*^9}],

Cell[TextData[{
 "This function computes matrix W used in Newhall\[CloseCurlyQuote]s equation \
(8). The parameter ",
 Cell[BoxData[
  FormBox["w", TraditionalForm]]],
 " is the weight of the velocities relative to the positions (0.4 in Newhall)."
}], "Text",
 CellChangeTimes->{{3.6408570334555626`*^9, 3.6408571098402004`*^9}, {
  3.640857486657981*^9, 3.6408574912574406`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewhallW", "[", 
   RowBox[{"divisions_Integer", ",", "w_Rational"}], "]"}], ":=", 
  RowBox[{"DiagonalMatrix", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        SuperscriptBox["w", "2"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"divisions", "+", "1"}], "}"}]}], "]"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.640842833046232*^9, 3.640842900460275*^9}, {
   3.6408429332455535`*^9, 3.640842987728001*^9}, {3.6408533478116283`*^9, 
   3.6408533592287703`*^9}, {3.640853483015147*^9, 3.6408534874775934`*^9}, {
   3.640854015234364*^9, 3.640854124766919*^9}, 3.6408567878600054`*^9}],

Cell[TextData[{
 "The following functions compute the four blocks of matrix ",
 Cell[BoxData[
  FormBox["C1", TraditionalForm]]],
 " and assemble them to form ",
 Cell[BoxData[
  FormBox[
   RowBox[{"C1", "."}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.6408571245626726`*^9, 3.6408571787170877`*^9}, {
  3.6408575023465495`*^9, 3.640857503690684*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewhallC1UpperLeft", "[", 
   RowBox[{"degree_Integer", ",", "divisions_Integer", ",", "w_Rational"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"NewhallT", "[", 
     RowBox[{"degree", ",", "divisions"}], "]"}], "\[Transpose]"}], ".", 
   RowBox[{"NewhallW", "[", 
    RowBox[{"divisions", ",", "w"}], "]"}], ".", 
   RowBox[{"NewhallT", "[", 
    RowBox[{"degree", ",", "divisions"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.640853443244171*^9, 3.640853467581604*^9}, {
   3.6408534985587015`*^9, 3.640853592034048*^9}, {3.6408536549423385`*^9, 
   3.6408537194387875`*^9}, {3.6408541425516977`*^9, 3.640854143790821*^9}, 
   3.640856787865006*^9, {3.641453211166113*^9, 3.6414532139371133`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewhallC1UpperRight", "[", "degree_Integer", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ChebyshevT", "[", 
       RowBox[{"i", ",", "1"}], "]"}], ",", 
      RowBox[{"DChebyshevT", "[", 
       RowBox[{"i", ",", "1"}], "]"}], ",", 
      RowBox[{"ChebyshevT", "[", 
       RowBox[{"i", ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      RowBox[{"DChebyshevT", "[", 
       RowBox[{"i", ",", 
        RowBox[{"-", "1"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "degree"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.64085418937838*^9, 3.6408542677952204`*^9}, {
  3.640855220759009*^9, 3.6408552602889614`*^9}, {3.6408584286307707`*^9, 
  3.6408584392868366`*^9}, {3.641452367410178*^9, 3.641452373349772*^9}, {
  3.6414532893421135`*^9, 3.641453290751113*^9}, {3.641453363655113*^9, 
  3.6414533646771135`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewhallC1LowerLeft", "[", "degree_Integer", "]"}], ":=", 
  RowBox[{
   RowBox[{"NewhallC1UpperRight", "[", "degree", "]"}], 
   "\[Transpose]"}]}]], "Input",
 CellChangeTimes->{{3.640855383275259*^9, 3.6408554096058917`*^9}, {
   3.6408554620481358`*^9, 3.640855514018332*^9}, 3.640855601901119*^9, {
   3.640855659206849*^9, 3.640855674303359*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewhallC1LowerRight", "[", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{"0", ",", 
    RowBox[{"{", "4", "}"}], ",", 
    RowBox[{"{", "4", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.640855718271755*^9, 3.640855795707498*^9}, {
  3.640855885414468*^9, 3.6408558912230487`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewhallC1", "[", 
   RowBox[{"degree_Integer", ",", "divisions_Integer", ",", "w_Rational"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"ArrayFlatten", "[", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NewhallC1UpperLeft", "[", 
        RowBox[{"degree", ",", "divisions", ",", "w"}], "]"}], ",", 
       RowBox[{"NewhallC1UpperRight", "[", "degree", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NewhallC1LowerLeft", "[", "degree", "]"}], ",", 
       RowBox[{"NewhallC1LowerRight", "[", "]"}]}], "}"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.640855947659692*^9, 3.6408560587898035`*^9}, 
   3.640856787869006*^9, {3.6414523940058374`*^9, 3.6414524071481514`*^9}, 
   3.6414539859468184`*^9}],

Cell[TextData[{
 "The following functions compute the two blocs of matrix ",
 Cell[BoxData[
  FormBox["C2", TraditionalForm]]],
 " and assemble them to form ",
 Cell[BoxData[
  FormBox[
   RowBox[{"C2", "."}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.6408571912667933`*^9, 3.640857228497167*^9}, {
  3.6408575122675414`*^9, 3.6408575292262373`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewhallC2Upper", "[", 
   RowBox[{"degree_Integer", ",", "divisions_Integer", ",", "w_Rational"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"NewhallT", "[", 
     RowBox[{"degree", ",", "divisions"}], "]"}], "\[Transpose]"}], ".", 
   RowBox[{"NewhallW", "[", 
    RowBox[{"divisions", ",", "w"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6408561523691607`*^9, 3.6408561603609595`*^9}, 
   3.640856787873007*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewhallC2Lower", "[", "divisions_Integer", "]"}], ":=", 
  RowBox[{"Drop", "[", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", 
     RowBox[{
      RowBox[{"2", " ", "divisions"}], "+", "2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", 
      RowBox[{"2", " ", "divisions"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.640856162231555*^9, 3.640856166466259*^9}, {
  3.6408562004592714`*^9, 3.640856240532278*^9}, {3.6408563085990844`*^9, 
  3.6408563257828026`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewhallC2", "[", 
   RowBox[{"degree_Integer", ",", "divisions_Integer", ",", "w_Rational"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"ArrayFlatten", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"NewhallC2Upper", "[", 
       RowBox[{"degree", ",", "divisions", ",", "w"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"NewhallC2Lower", "[", "divisions", "]"}], "}"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6408563549977236`*^9, 3.640856433276551*^9}, 
   3.6408567878780074`*^9, {3.641452430273464*^9, 3.641452435425979*^9}}],

Cell[TextData[{
 "This function computes the matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["C1", 
     RowBox[{"-", "1"}]], ".", "C2"}], TraditionalForm]]],
 ". Newhall doesn\[CloseCurlyQuote]t give it a name but calls its elements ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["c", "k"], TraditionalForm]]],
 ", so let\[CloseCurlyQuote]s use the name ",
 Cell[BoxData[
  FormBox["C", TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.64085755035935*^9, 3.6408577002573385`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewhallC", "[", 
   RowBox[{"degree_Integer", ",", "divisions_Integer", ",", "w_Rational"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"Inverse", "[", 
    RowBox[{"NewhallC1", "[", 
     RowBox[{"degree", ",", "divisions", ",", "w"}], "]"}], "]"}], ".", 
   RowBox[{"NewhallC2", "[", 
    RowBox[{"degree", ",", "divisions", ",", "w"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.640856537054928*^9, 3.6408566025854797`*^9}, 
   3.6408567878820076`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Formatting and Output", "Section",
 CellChangeTimes->{{3.6408719448172836`*^9, 3.640871955574359*^9}}],

Cell["\<\
Produces a representation of a matrix as an initializer_list containing \
initializer_lists.\
\>", "Text",
 CellChangeTimes->{{3.640882583696988*^9, 3.640882621413759*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BidimMatrixToCDefinition", "[", 
   RowBox[{"type_String", ",", "variable_String", ",", "matrix_List"}], "]"}],
   ":=", "\[IndentingNewLine]", 
  RowBox[{
  "type", "<>", "\"\< const\\r\\n    \>\"", "<>", "variable", "<>", 
   "\"\<(\\r\\n\>\"", "<>", "\[IndentingNewLine]", 
   RowBox[{"StringReplace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"CForm", "[", "matrix", "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<List(List(\>\"", "\[Rule]", "\"\<        {{\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<List(\>\"", "\[Rule]", "\"\<{\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<),\>\"", "\[Rule]", "\"\<},\\r\\n        \>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<,\>\"", "\[Rule]", "\"\<,\\r\\n         \>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<))\>\"", "\[Rule]", "\"\<}});\\r\\n\\r\\n\>\""}]}], 
      "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.640870677895302*^9, 3.6408709164751577`*^9}, {
   3.6408713800455103`*^9, 3.6408714014446497`*^9}, {3.6408715712869344`*^9, 
   3.6408715864944553`*^9}, {3.6408716910189066`*^9, 3.640871730579862*^9}, {
   3.640871771621966*^9, 3.6408717737571793`*^9}, {3.6408718178715906`*^9, 
   3.640871822896093*^9}, {3.640871860952898*^9, 3.640871871400943*^9}, {
   3.6408724733271294`*^9, 3.640872505568353*^9}, {3.640874245098493*^9, 
   3.640874246393623*^9}, 3.6408747449167724`*^9, {3.641055252528308*^9, 
   3.641055258999955*^9}, {3.6410553154505997`*^9, 3.6410553219702516`*^9}, {
   3.6412257405560822`*^9, 3.641225745627589*^9}, {3.6414524528777237`*^9, 
   3.6414524755639925`*^9}, 3.6414540083400574`*^9}],

Cell["\<\
Produces a representation of a matrix as a single, flattened initializer list.\
\>", "Text",
 CellChangeTimes->{{3.6408826244020576`*^9, 3.640882652052823*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlattenedMatrixToCDefinition", "[", 
   RowBox[{"type_String", ",", "variable_String", ",", "matrix_List"}], "]"}],
   ":=", "\[IndentingNewLine]", 
  RowBox[{
  "type", "<>", "\"\< const\\r\\n    \>\"", "<>", "variable", "<>", 
   "\"\<(\\r\\n\>\"", "<>", "\[IndentingNewLine]", 
   RowBox[{"StringReplace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"CForm", "[", "matrix", "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<List(List(\>\"", "\[Rule]", "\"\<        {\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<List(\>\"", "\[Rule]", "\"\<\\r\\n         \>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<),\>\"", "\[Rule]", "\"\<,\\r\\n\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<,\>\"", "\[Rule]", "\"\<,\\r\\n         \>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<))\>\"", "\[Rule]", "\"\<});\\r\\n\\r\\n\>\""}]}], 
      "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.640870677895302*^9, 3.6408709164751577`*^9}, {
   3.6408713800455103`*^9, 3.6408714014446497`*^9}, {3.6408715712869344`*^9, 
   3.6408715864944553`*^9}, {3.6408716910189066`*^9, 3.640871730579862*^9}, {
   3.640871771621966*^9, 3.6408717737571793`*^9}, {3.6408718178715906`*^9, 
   3.640871822896093*^9}, {3.640871860952898*^9, 3.640871871400943*^9}, {
   3.6408724733271294`*^9, 3.640872505568353*^9}, {3.640873553407629*^9, 
   3.640873574721777*^9}, {3.640873643516341*^9, 3.640873653644354*^9}, {
   3.640873798850873*^9, 3.6408738466276503`*^9}, {3.640873894997487*^9, 
   3.6408738985728445`*^9}, {3.6408739333513217`*^9, 3.64087394163015*^9}, 
   3.6408740023772235`*^9, {3.640874047938779*^9, 3.6408740806520505`*^9}, {
   3.640874124837468*^9, 3.6408741261495996`*^9}, {3.640874162015186*^9, 
   3.6408742111931033`*^9}, {3.6408742498659697`*^9, 3.6408742514901323`*^9}, 
   3.6408744376087427`*^9, 3.6408747372680073`*^9, {3.6410552648555403`*^9, 
   3.6410552735364084`*^9}, {3.6410553246105156`*^9, 3.641055328873942*^9}, {
   3.641225750852112*^9, 3.641225754428469*^9}, {3.641452466777114*^9, 
   3.6414524765610924`*^9}, 3.641454028986122*^9}],

Cell["Produces a representation of a list as an initializer list.", "Text",
 CellChangeTimes->{{3.640882654947112*^9, 3.640882678263444*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListToCDefinition", "[", 
   RowBox[{"type_String", ",", "variable_String", ",", "list_List"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{
  "type", "<>", "\"\< const\\r\\n    \>\"", "<>", "variable", "<>", 
   "\"\<(\\r\\n\>\"", "<>", "\[IndentingNewLine]", 
   RowBox[{"StringReplace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"CForm", "[", "list", "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<List(\>\"", "\[Rule]", "\"\<        {\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<,\>\"", "\[Rule]", "\"\<,\\r\\n         \>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<)\>\"", "\[Rule]", "\"\<});\\r\\n\\r\\n\>\""}]}], "}"}]}],
     "]"}]}]}]], "Input",
 CellChangeTimes->{{3.640870677895302*^9, 3.6408709164751577`*^9}, {
   3.6408713800455103`*^9, 3.6408714014446497`*^9}, {3.6408715712869344`*^9, 
   3.6408715864944553`*^9}, {3.6408716910189066`*^9, 3.640871730579862*^9}, {
   3.640871771621966*^9, 3.6408717737571793`*^9}, {3.6408718178715906`*^9, 
   3.640871822896093*^9}, {3.640871860952898*^9, 3.640871871400943*^9}, {
   3.6408724733271294`*^9, 3.640872505568353*^9}, {3.6408731435046425`*^9, 
   3.64087318448174*^9}, 3.6408732463239236`*^9, {3.640874725203801*^9, 
   3.6408747298602667`*^9}, {3.641055278559911*^9, 3.641055282736328*^9}, {
   3.6410553310581603`*^9, 3.641055333330387*^9}, {3.6412257584598722`*^9, 
   3.6412257617562017`*^9}, {3.6414524794533815`*^9, 3.6414524839628325`*^9}, 
   3.6414540313563595`*^9}],

Cell[TextData[{
 "Writes all the Newhall ",
 Cell[BoxData[
  FormBox["C", TraditionalForm]]],
 " matrices to a single file.  Note that we drop the last 4 rows because they \
correspond to the Lagrange multipliers."
}], "Text",
 CellChangeTimes->{{3.6408826935639734`*^9, 3.640882714496066*^9}, {
  3.6410550089579535`*^9, 3.6410550237494326`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{"OpenWrite", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DirectoryName", "[", 
         RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
        "\"\<numerics\>\"", ",", "\"\<newhall.mathematica.cpp\>\""}], "}"}], 
      "]"}], ",", 
     RowBox[{"BinaryFormat", "\[Rule]", "True"}], ",", 
     RowBox[{"PageWidth", "\[Rule]", "Infinity"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", "\[IndentingNewLine]", 
   RowBox[{
   "file", ",", "\[IndentingNewLine]", 
    "\"\<// Generated by Mathematica.  DO NOT EDIT!\\r\\n\>\"", ",", 
    "\[IndentingNewLine]", "\"\<// source: mathematica/newhall.nb\\r\\n\>\"", 
    ",", "\[IndentingNewLine]", "\"\<\\r\\n\>\"", ",", "\[IndentingNewLine]", 
    "\"\<#pragma once\\r\\n\>\"", ",", "\[IndentingNewLine]", 
    "\"\<\\r\\n\>\"", ",", "\[IndentingNewLine]", 
    "\"\<#include <array>\\r\\n\>\"", ",", "\[IndentingNewLine]", 
    "\"\<\\r\\n\>\"", ",", "\[IndentingNewLine]", 
    "\"\<#include \\\"numerics/fixed_arrays.hpp\\\"\\r\\n\>\"", ",", 
    "\[IndentingNewLine]", "\"\<\\r\\n\>\"", ",", "\[IndentingNewLine]", 
    "\"\<namespace principia {\\r\\n\>\"", ",", "\[IndentingNewLine]", 
    "\"\<namespace numerics {\\r\\n\>\"", ",", "\"\<\\r\\n\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WriteString", "[", "\[IndentingNewLine]", 
     RowBox[{"file", ",", "\[IndentingNewLine]", 
      RowBox[{"FlattenedMatrixToCDefinition", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<FixedMatrix<double, \>\"", "<>", 
         RowBox[{"ToString", "[", "degree", "]"}], "<>", 
         "\"\< + 1, 2 * 8 + 2>\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<newhall_c_matrix_degree_\>\"", "<>", 
         RowBox[{"ToString", "[", "degree", "]"}], "<>", 
         "\"\<_divisions_8_w04\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"NewhallC", "[", 
           RowBox[{"degree", ",", "8", ",", 
            RowBox[{"4", "/", "10"}]}], "]"}], ",", 
          RowBox[{"-", "4"}]}], "]"}]}], "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"degree", ",", " ", "3", ",", " ", "17"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", "\[IndentingNewLine]", 
   RowBox[{
   "file", ",", "\[IndentingNewLine]", 
    "\"\<}  // namespace numerics\\r\\n\>\"", ",", "\[IndentingNewLine]", 
    "\"\<}  // namespace principia\\r\\n\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "file", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6408690404944735`*^9, 3.6408690482152452`*^9}, {
   3.6408693014015617`*^9, 3.640869306833105*^9}, {3.64086966050257*^9, 
   3.6408696679353137`*^9}, {3.6408719952213235`*^9, 
   3.6408720075415554`*^9}, {3.640872044038205*^9, 3.640872102017002*^9}, 
   3.6408721784836483`*^9, {3.6408744896339445`*^9, 3.640874697836065*^9}, {
   3.640882308660487*^9, 3.640882443122932*^9}, {3.6408824910527244`*^9, 
   3.6408825377573943`*^9}, {3.640882740269644*^9, 3.6408827442540417`*^9}, {
   3.640882817697688*^9, 3.640882841442062*^9}, 3.640883007384655*^9, {
   3.6410549728233404`*^9, 3.641055004952553*^9}, {3.641055406823736*^9, 
   3.641055407894843*^9}, 3.6410559850527554`*^9, {3.641056477791024*^9, 
   3.6410564808393292`*^9}, {3.641225627514779*^9, 3.6412256470907364`*^9}, {
   3.6412256903320603`*^9, 3.641225714741501*^9}, {3.6412258377471027`*^9, 
   3.6412258380261307`*^9}, 3.6414521120446444`*^9, {3.6414521496064*^9, 
   3.6414521770771465`*^9}, {3.6414522177812166`*^9, 3.641452272660704*^9}, {
   3.6414523262270603`*^9, 3.641452333385776*^9}, {3.6414524968361197`*^9, 
   3.641452556058041*^9}, {3.641454038241048*^9, 3.641454079778201*^9}}],

Cell["\<\
Saves a pdf printout of this notebook for documentation purposes.\
\>", "Text",
 CellChangeTimes->{{3.641453115758113*^9, 3.6414531324961133`*^9}}],

Cell[BoxData[
 RowBox[{"printout", "=", "\[IndentingNewLine]", 
  RowBox[{"NotebookPrint", "[", 
   RowBox[{
    RowBox[{"EvaluationNotebook", "[", "]"}], ","}], "]"}]}]], "Input",
 CellChangeTimes->{{3.641452910652113*^9, 3.641452915609113*^9}, {
  3.641452984209113*^9, 3.6414529900621133`*^9}, {3.6414530475261135`*^9, 
  3.641453073907113*^9}, {3.641453111057113*^9, 3.641453111975113*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1260, 1336},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 133, 1, 101, "Title"],
Cell[715, 25, 239, 3, 56, "Subtitle"],
Cell[CellGroupData[{
Cell[979, 32, 99, 1, 70, "Section"],
Cell[1081, 35, 161, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[1267, 42, 509, 9, 31, "Input"],
Cell[1779, 53, 421, 11, 31, "Output"]
}, Open  ]],
Cell[2215, 67, 817, 19, 49, "Text"],
Cell[3035, 88, 1745, 40, 132, "Input"],
Cell[4783, 130, 380, 8, 30, "Text"],
Cell[5166, 140, 716, 17, 33, "Input"],
Cell[5885, 159, 363, 10, 30, "Text"],
Cell[6251, 171, 747, 16, 52, "Input"],
Cell[7001, 189, 973, 24, 52, "Input"],
Cell[7977, 215, 385, 8, 31, "Input"],
Cell[8365, 225, 324, 8, 31, "Input"],
Cell[8692, 235, 837, 20, 72, "Input"],
Cell[9532, 257, 361, 10, 30, "Text"],
Cell[9896, 269, 461, 12, 31, "Input"],
Cell[10360, 283, 522, 13, 31, "Input"],
Cell[10885, 298, 620, 15, 52, "Input"],
Cell[11508, 315, 508, 16, 32, "Text"],
Cell[12019, 333, 487, 12, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12543, 350, 108, 1, 70, "Section"],
Cell[12654, 353, 182, 4, 30, "Text"],
Cell[12839, 359, 1789, 34, 192, "Input"],
Cell[14631, 395, 170, 3, 30, "Text"],
Cell[14804, 400, 2247, 40, 192, "Input"],
Cell[17054, 442, 141, 1, 30, "Text"],
Cell[17198, 445, 1613, 30, 152, "Input"],
Cell[18814, 477, 347, 8, 30, "Text"],
Cell[19164, 487, 3965, 78, 572, "Input"],
Cell[23132, 567, 157, 3, 30, "Text"],
Cell[23292, 572, 394, 7, 52, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
